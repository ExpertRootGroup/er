void estimateDeadLayerOneSpectrum () {
    
  vector<vector<Double_t>> channelsDir = {{209.398, 267.369, 345.331}, 
                                          {209.398, 267.369, 348.33 },
                                          {211.397, 271.367, 352.328}, 
                                          {203.401, 261.372, 341.333}, 
                                          {210.397, 269.368, 349.329}, 
                                          {207.399, 266.37 ,  347.33},
                                          {218.393, 280.363, 364.322}, 
                                          {201.402, 258.374, 336.336}, 
                                          {200.402, 257.374, 334.337}, 
                                          {206.399, 265.37 , 346.331}, 
                                          {205.4  , 263.371, 342.333},
                                          {201.402, 258.374, 337.335},
                                          {204.4  , 261.372, 339.334},
                                          {206.399, 266.37 ,  347.33},
                                          {214.395, 273.366, 355.326},
                                          {206.399, 265.37 , 346.331}, 
                                          {213.396, 272.367, 353.327},
                                          {207.399, 265.37 , 345.331}, 
                                          {211.397, 270.368, 350.329},
                                          {202.401, 259.373, 338.335},
                                          {208.398, 266.37 , 346.331}, 
                                          {208.398, 267.369, 347.33 },
                                          {213.396, 273.366, 355.326},
                                          {208.398, 267.369, 349.329},
                                          {215.395, 276.365, 358.325},
                                          {207.399, 266.37 , 346.331}, 
                                          {209.398, 268.369, 348.33 },
                                          {205.4  ,263.371 , 343.332},
                                          {214.395, 275.365, 357.325},
                                          {206.399, 264.371, 344.332},
                                          {214.395, 273.366, 355.326},
                                          {202.401, 260.373, 339.334}};
                                          
  vector<vector<Double_t>> channelsRot = {{203.401, 261.372, 340.334}, 
                                          {203.401, 262.372, 343.332}, 
                                          {205.4  , 265.37 ,  347.33}, 
                                          {197.404, 256.375, 336.336}, 
                                          {204.4  , 263.371, 345.331}, 
                                          {201.402, 261.372, 342.333}, 
                                          {212.396, 274.366, 359.324},  
                                          {195.405, 253.376, 332.338}, 
                                          {195.405, 252.377, 330.339}, 
                                          {200.402, 260.373, 341.333}, 
                                          {200.402, 258.374, 337.335}, 
                                          {195.405, 253.376, 332.338}, 
                                          {198.403, 256.375, 335.336}, 
                                          {201.402, 261.372, 342.333}, 
                                          {207.399, 268.369, 351.328}, 
                                          {201.402, 260.373, 342.333}, 
                                          {207.399, 268.369, 349.329}, 
                                          {201.402, 260.373, 341.333}, 
                                          {205.4  , 265.37 , 346.331}, 
                                          {196.404, 255.375, 334.337}, 
                                          {203.401, 262.372, 342.333}, 
                                          {202.401, 262.372, 343.332}, 
                                          {208.398, 269.368, 351.328}, 
                                          {203.401, 263.371, 345.331}, 
                                          {210.397, 271.367, 354.327}, 
                                          {202.401, 262.372, 343.332}, 
                                          {204.4  , 263.371, 344.332}, 
                                          {199.403, 259.373, 339.334}, 
                                          {209.398, 270.368, 353.327}, 
                                          {201.402, 260.373, 340.334}, 
                                          {208.398, 269.368, 351.328}, 
                                          {198.403, 256.375, 335.336}};

  Double_t n1 = 161.002 , n3 = 99.1315, n4 = 62.6388;
  Double_t m1 = 1.48196 , m3 = 1.28194, m4 = 1.08652;
  Double_t E1 = 4.7844*1e-3, E3 = 6.0024*1e-3, E4 = 7.6869*1e-3;
  int i = 0;
  ofstream file;
  file.open("estimDead.txt", ios::trunc);
  for (int ind = 0; ind < 32; ind++) {
    Double_t N1 = channelsDir[ind][0], N3 = channelsDir[ind][1], N4 = channelsDir[ind][2];
    Double_t a = m3*(N1-N4) + m4*(N3-N1) + m1*(N4-N3);
    Double_t b = n3*(N1-N4) + n4*(N3-N1) + n1*(N4-N3);
    Double_t c = N4*(E3-E4) + N1*(E4-E3) + N3*(E1-E4);
    Double_t d1 = (-b + sqrt(pow(b, 2) - 4*a*c)) / 2 /a;
    cout << "d1_" << ind << " = " << d1 << endl; 
    N1 = channelsRot[ind][0], N3 = channelsRot[ind][1], N4 = channelsRot[ind][2];
    a = m3*(N1-N4) + m4*(N3-N1) + m1*(N4-N3);
    b = n3*(N1-N4) + n4*(N3-N1) + n1*(N4-N3);
    c = N4*(E3-E4) + N1*(E4-E3) + N3*(E1-E4);
    Double_t d2 = (-b + sqrt(pow(b, 2) - 4*a*c)) / 2 /a;
    cout << "d2_" << ind << " = " << d2 << endl; 
    file << d1 << setw(15) << d2 << setw(15) << TMath::RadToDeg()*acos(d1/d2) << endl;
    Double_t coefA = (E1 - E3 + (m3-m1)*pow(d1,2) + (n3-n1)*d1) / (N1-N3);
    Double_t coefB = E1 - m1*pow(d1,2) - n1*d1 - coefA * N1;
    cout << "a = " << coefA << endl;
    cout << "b = " << coefB << endl;
    cout << m1*pow(d1,2) << " " << n1*d1 << " " << coefA * N1 << endl;
  } 
}
